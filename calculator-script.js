// productData.js


const productData = {
    egic: {
        BR: {
            "1/2 قطر": [
                { name: "متر مواسير 1/2", price: 31.5 }, { name: "كوع لحام 1/2", price: 12.75 },
                { name: "كوع مفتوح لحام 1/2", price: 21.5 }, { name: "تي لحام 1/2", price: 18.5 },
                { name: "كرنك قصير 1/2", price: 32.5 }, { name: "جلبه لحام 1/2", price: 13 },
                { name: "كوع بسن 1/2* 1/2", price: 87.5 }, { name: "تي بسن 1/2* 1/2", price: 101.25 },
                { name: "جلبه بسن داخلي 1/2* 1/2", price: 92.5 }, { name: "جلبه بسن خارجي 1/2* 1/2", price: 98.5 },
                { name: "محبس دفن 1/2", price: 498.75 }, { name: "محبس 2 لاكور 1/2 1/2", price: 352 }
            ],
            "قطر 3/4 بوصه": [
                { name: "متر مواسير 3/4", price: 53 }, { name: "كوع لحام 3/4", price: 17.5 },
                { name: "كوع مفتوح لحام 3/4", price: 24.5 }, { name: "تي لحام 3/4", price: 23.75 },
                { name: "كرنك قصير 3/4", price: 40.25 }, { name: "جلبه لحام 3/4", price: 14.25 },
                { name: "كوع بسن 1/2* 3/4", price: 100.75 }, { name: "تي بسن 1/2* 1/2", price: 134 },
                { name: "جلبه بسن داخلي 1/2* 3/4", price: 122 }, { name: "جلبه بسن خارجي 1/2* 3/4", price: 135.25 },
                { name: "محبس دفن 3/4", price: 513.5 }, { name: "محبس 2 لاكور 3/4", price: 482.5 }
            ],
            "قطر 1 بوصه": [
                { name: "متر مواسير 1 بوصه", price: 76 }, { name: "كوع لحام 1 بوصه", price: 33.5 },
                { name: "كوع مفتوح لحام 1 بوصه", price: 36.5 }, { name: "تي لحام 1 بوصه", price: 43.25 },
                { name: "'طبه كاب 1 بوصه", price: 28.75 }, { name: "جلبه لحام 1 بوصه", price: 24.25 },
                { name: "كوع بسن 1 بوصه", price: 310.75 }, { name: "تي بسن 1 بوصه", price: 358 },
                { name: "جلبه بسن داخلي 1 بوصه", price: 227.75 }, { name: "جلبه بسن خارجي 1 بوصه", price: 311.5 },
                { name: "محبس دفن 1 بوصه", price: 640 }, { name: "محبس 2 لاكور 1 بوصه", price: 656.5 }
            ],
            "قطر 1.5 بوصه": [
                { name: "متر مواسير1.5 بوصه", price: 182 }, { name: "كوع لحام 1.5 بوصه", price: 124 },
                { name: "كوع مفتوح لحام 1.5 بوصه", price: 128.75 }, { name: "تي لحام 1.5 بوصه", price: 136.25 },
                { name: "جلبه لحام 1.5 بوصه", price: 74.75 }, // تم تصحيح هذا الاسم
                { name: "طبه كاب 1.5 بوصه", price: 88 },
                { name: "جلبه بسن داخلي 1.5 بوصه", price: 554.5 }, { name: "جلبه بسن خارجي 1.5 بوصه", price: 554 },
                { name: "تي مسلوب 1*1.5 بوصه", price: 155 }, { name: "محبس 2 لاكور 1.5 بوصه", price: 1630 }
            ]
        },





        SMART: {
            "قطر 1 بوصه": [
                { name: "متر مواسير 1 بوصه", price: 51.5 }, { name: "كوع عاده1 بوصه", price: 15.25 },
                { name: "كوع مفتوح 1 بوصه", price: 15.25}, { name: "تي عاده 1 بوصه", price: 22.25 },
                { name: "تي واي 1 بوصه", price: 25 }, { name: "جلبه لزق 1 بوصه", price: 13.75 },
                { name: "مسلوب 1 بوصه * 1.5", price: 26 }, { name: "متر مواسير خفيف 1 بوصه", price: 31.5 }
            ],
            "قطر 1.5 بوصه": [
                { name: "متر مواسير1.5 بوصه", price: 77.5 }, { name: "كوع عاده 1.5 بوصه", price: 23 },
                { name: "كوع مفتوح 1.5 بوصه", price: 27.5}, { name: "تي عاده 1.5 بوصه", price: 37},
                { name: "تي واي 1.5 بوصه", price: 55.5}, { name: "جلبه لزق 1.5 بوصه", price: 23 },
                { name: "كوع بسن بانيو 1.5 بوصه", price: 31.5 }, { name: "جلبه بسن 1.5 بانيو 1 بوصه", price: 32 },
                { name: "متر مواسير خفيف 1.5 بوصه", price: 63.25 }
            ],
            "قطر 2 بوصه": [
                { name: "متر مواسير2 بوصه", price: 105.5 }, { name: "كوع عاده 2 بوصه", price: 36.75 },
                { name: "كوع مفتوح 2 بوصه", price: 41.25 }, { name: "تي عاده 2 بوصه", price: 47 },
                { name: "تي واي 2 بوصه", price: 69.75}, { name: "تي بباب 2 بوصه", price: 81.5},
                { name: "بيبه سمارت 7 سم 2*1.5", price: 142.5 }, { name: "بيبه سمارت 10 سم 2*1.5", price: 181.25 },
                { name: "مسلوب2*1.5 بوصه", price: 30.25}, { name: "متر مواسير خفيف 2 بوصه", price: 87.5 }
            ],
            "قطر 3 بوصه": [
                { name: "متر مواسير 3", price: 137.5 }, { name: "كوع عاده 3 بوصه", price: 64 },
                { name: "كوع مفتوح 3 بوصه", price: 60.5}, { name: "تي عاده 3 بوصه", price: 107.75},
                { name: "تي واي 3 بوصه", price: 124}, { name: "تي عاده 3*2", price: 158.75},
                { name: "تي بباب 3*2", price: 169.5}, { name: "جلبه 3 بوصه", price: 51.25},
               { name: "بيبه سمارت 3*1.5", price: 181.25 }, { name: "بيبه سمارت 10 سم 3*2", price: 181.25 },
                { name: "متر مواسير خفيف 3 بوصه", price: 116.75 }
            ],
            "قطر 4 بوصه": [
                { name: "متر مواسير 4 بوصه", price: 215.25}, { name: "كوع عاده 4 بوصه", price: 120 },
                { name: "كوع مفتوح 4 بوصه", price: 103.5}, { name: "تي عاده 4 بوصه", price: 176 },
                { name: "تي واي 4 بوصه", price: 215.5}, { name: "تي عاده 4*2", price: 238.75 },
                { name: "تي بباب 4*2", price: 245.5 }, { name: "جلبه 4 بوصه", price: 80.25},
                { name: "تي بباب 4*3", price: 245.5}, { name: "تي عاده 4*3", price: 233.25 },
                { name: "متر مواسير خفيف 4 بوصه", price: 166.75 }
            ]
        },

		
		
		
		
        KESSEL: {
            "قطر32 مم": [
                { name: "متر مواسير 32 مم", price: 46.25}, { name: "كوع عاده 32 مم", price: 19},
                { name: "كوع مفتوح 32 مم", price:20.5 }, { name: "تي عاده 32 مم", price: 41},
                { name: "تي واي 32 مم", price: 42.5 }, { name: "جلبه لحام 32 مم", price: 24.5 },
                { name: "مسلوب 32*50 مم", price:27.25 }, { name: "طبه كاب 32 مم", price: 10.25 }
            ],
            "قطر50 مم": [
                { name: "متر مواسير 50 مم", price: 59 }, { name: "كوع عاده 50 مم", price: 26.75 },
                { name: "كوع مفتوح 50 مم", price: 27.5 }, { name: "تي عاده 50 مم", price: 55.25 },
                { name: "تي واي 50 مم", price: 57 }, { name: "جلبه لحام 50 مم", price: 32.5 },
                { name: "جلبة اصلاح 50 مم", price: 37.25 }
            ],
            "قطر63 مم": [
                { name: "متر مواسير 63 مم", price: 71 }, { name: "كوع عاده 63 مم", price: 41.5 },
                { name: "كوع مفتوح 63 مم", price: 39 }, { name: "طبه كاب 63 مم", price: 32 },
                { name: "تي واي 63 مم", price: 68.75 }, { name: "جلبه لحام 63 مم", price: 49 },
                { name: "بيبه 75*63 مم", price: 269.5 }, { name: "جلبة اصلاح 63 مم", price: 57.5 }
            ],
            "قطر75 مم": [
                { name: "متر مواسير 75 مم", price: 90 }, { name: "كوع عاده 75 مم", price: 54.25 },
                { name: "كوع مفتوح 75 مم", price: 42.75}, { name: "تي عاده 75 مم", price: 74.75 },
                { name: "تي واي 75 مم", price: 76.5 }, { name: "جلبه لحام 75 مم", price: 12.75 },
                { name: "بيبه 75*50 مم", price: 236.25 }, { name: "متر مواسير خفيف 63 مم", price: 83.25 },
                { name: "تي بباب  75 مم", price: 120 }, { name: "هوايه 75 مم", price: 32.75 }
            ],
            "قطر110 مم": [
                { name: "متر مواسير 110 مم", price: 161.75 }, { name: "كوع عاده 110 مم", price: 66.5 },
                { name: "كوع مفتوح 110 مم", price: 67 }, { name: "تي عاده 110 مم", price: 117 },
                { name: "تي واي 110 مم", price: 118.25 }, { name: "جلبه لحام 110 مم", price: 66.75 },
                { name: "سيفون ريحه 110 مم", price: 197.25 }, { name: "مسلوب  110*75 مم", price: 67.75 },
                { name: "صليبه 110 مم", price: 288 }, { name: "هوايه 110 مم", price: 47.75 }
            ]
        }
    },


		
				
    belissa: {
        بولي: {
            "1/2 قطر": [
                { name: "متر مواسير 1/2", price: 24.5 }, { name: "كوع لحام 1/2", price: 4.7 },
                { name: "طبة اختبار 1/2", price: 4}, { name: "تي لحام 1/2", price: 7 },
                { name: "كرنك قصير 1/2", price: 9.5 }, { name: "جلبه لحام 1/2", price: 3 },
                { name: "كوع بسن 1/2* 1/2", price: 33 }, { name: "تي بسن 1/2* 1/2", price: 30.5 },
                { name: "جلبه بسن داخلي 1/2* 1/2", price: 26.5 }, { name: "جلبه بسن خارجي 1/2* 1/2", price: 40 },
                { name: "محبس دفن 1/2", price: 316.5 }, { name: "محبس دفن مشروعات 1/2 1/2", price: 270}
            ],
            "قطر 3/4 بوصه": [
                { name: "متر مواسير 3/4", price: 36.5 }, { name: "كوع لحام 3/4", price: 7.4},
                { name: "كوع مفتوح لحام 3/4", price: 9}, { name: "تي لحام 3/4", price: 12.5},
                { name: "كرنك قصير 3/4", price: 14}, { name: "جلبه لحام 3/4", price: 4.75},
                { name: "كوع بسن 1/2* 3/4", price: 34}, { name: "تي بسن 1/2* 1/2", price: 34},
                { name: "جلبه بسن داخلي 1/2* 3/4", price: 30.5}, { name: "جلبه بسن خارجي 1/2* 3/4", price: 46},
                { name: "محبس دفن 3/4", price: 350}, { name: "محبس دفن مشروعات 3/4", price: 300}
            ],
            "قطر 1 بوصه": [
                { name: "متر مواسير 1 بوصه", price: 60.5}, { name: "كوع لحام 1 بوصه", price: 12},
                { name: "كوع مفتوح لحام 1 بوصه", price: 15}, { name: "تي لحام 1 بوصه", price: 12.75 },
                { name: "محبس 2 لاكور 1 بوصه", price: 535}, { name: "جلبه لحام 1 بوصه", price: 10.5},
                { name: "متر 1 بوصه بي ان 16", price: 53}, { name: "طبه كاب 1 بوصه", price: 9 },
                { name: "جلبه بسن داخلي 1 بوصه", price: 65}, { name: "جلبه بسن خارجي 1 بوصه", price: 95}        
            ],
            "قطر 1.5 بوصه": [
                { name: "متر مواسير1.5 بوصه", price: 158.5}, { name: "كوع لحام 1.5 بوصه", price: 30},
                { name: "تي لحام 1.5بوصه", price: 51}, { name: "جلبه لحام 1.5 بوصه", price: 23.5},
                { name: "جلبه بسن داخلي 1.5 بوصه", price: 165}, { name: "جلبه بسن خارجي 1.5 بوصه", price: 195},
                { name: "مسلوب 1*1.5 بوصه", price: 34.5}, { name: "طبه كاب 1.5 بوصه", price: 30}
            ]
        },
    },
		
		
		
		
    economy: {
        رفايع: {
            "عام": [
                { name: "محبس زاويه استانليس", price: 50 }, { name: "حنفية غساله نحاس صغيره", price: 60 },
                { name: "حنفيه بولي خلف نحاس", price: 30 }, { name: "حنفيه بليه 1/2نحاس", price: 60 },
                { name: "جلبه استانليس 1/2*1/2", price: 15 }, { name: "وش نيكل مدور ", price: 7 },
                { name: "سيفون حوض سوسته", price: 25 }, { name: "طقم مسمار قاعده / حوض / سخان", price: 20 },
                { name: "حله استانليس 35*40 سمك .5 مم", price: 435 }, { name: "سيفون سوسته لحلة المطبخ ", price: 50 },
                { name: "جلبه سوسته للقاعده", price: 50 }, { name: "غطا بيبه استاليس", price: 60 },
                { name: "سماعة دش كامله", price: 120 }, { name: "شطاف اتوماتيك تقليد ايطالي", price: 80 },
                { name: "قلب 3 لنيه و 3.5 مختوم ايطالي", price: 20 }, { name: "اكره خلاط ", price: 20 },
                { name: "قلب مختوم الماني ", price: 40 }, { name: "قلب 1/2 سن مختوم ايطالي", price: 30 },
                { name: "ماكينه صندوق للقاعده", price: 85 }, { name: "سديلي للقاعده", price: 140 },
                { name: "وصله اسباني 30 , 40 , 50 , 60", price: 25 }, { name: "وصله شجره 30 , 40 , 50 , 60", price: 25 }
            ]
        },
        خلاطات: {
            "عام": [
                { name: "طقم خلاط روكا مصري 3 قطع", price: 1000 },
                { name: "خلاط دش روكا مصري ", price: 400 },
                { name: "خلاط حوض وش روكا مصري", price: 300 },
                { name: "خلاط حوض مطبخ روكا مصري", price: 300 },
                { name: "خلاط شطاف روكا مصري", price: 400 }
            ]
        },
        اطقم: {
            "عام": [
                { name: "طقم صيني اقتصادي كامل", price: 2050 },
                { name: "حوض بركبه صيني اقتصادي ", price: 550 },
                { name: "قاعده صيني كامله بمشتملاتها ", price: 1650 }
            ]
        }
    },
	
	
	
    lux: {
        'نواكل فاخر': {
            'عام': [
                { name: "شاور بانر ديجيتال فيدمر", price: 5500 },
                { name: "مسطره دهبي 2*1 الجرس", price: 1450 },
                { name: "حله سمارت كوري", price: 3400 },
                { name: "سماعة دش هد كبير سرعات", price: 300 }
            ]
        }
    }
};
	




// أرقام الواتساب الثابتة
const WHATSAPP_RETAIL = "201122019099";   // حسن العدوي
const WHATSAPP_WHOLESALE = "201129777012"; // أحمد إدريس

// تحميل الأقسام عند اختيار الشركة
document.getElementById('companySelect').addEventListener('change', function() {
  const company = this.value;
  const sectionSelect = document.getElementById('sectionSelect');
  const sectionContainer = document.getElementById('sectionContainer');
  const sizeContainer = document.getElementById('sizeContainer');
  const itemsContainer = document.getElementById('itemsContainer');

  sectionSelect.innerHTML = '<option value="">-- اختر القسم --</option>';
  sizeContainer.style.display = 'none';
  itemsContainer.innerHTML = '';

  if (company && productData[company]) {
    sectionContainer.style.display = 'block';
    Object.keys(productData[company]).forEach(section => {
      const opt = document.createElement('option');
      opt.value = section;
      opt.textContent = section;
      sectionSelect.appendChild(opt);
    });
  } else {
    sectionContainer.style.display = 'none';
  }
});

// تحميل المقاسات عند اختيار القسم
document.getElementById('sectionSelect').addEventListener('change', function() {
  const company = document.getElementById('companySelect').value;
  const section = this.value;
  const sizeSelect = document.getElementById('sizeSelect');
  const sizeContainer = document.getElementById('sizeContainer');
  const itemsContainer = document.getElementById('itemsContainer');

  sizeSelect.innerHTML = '<option value="">-- اختر القطر --</option>';
  itemsContainer.innerHTML = '';

  if (section && productData[company][section]) {
    const sizes = Object.keys(productData[company][section]);
    if (sizes.length === 1 && sizes[0] === "عام") {
      sizeContainer.style.display = 'none';
      loadItems(company, section, "عام");
    } else {
      sizeContainer.style.display = 'block';
      sizes.forEach(size => {
        const opt = document.createElement('option');
        opt.value = size;
        opt.textContent = size;
        sizeSelect.appendChild(opt);
      });
    }
  } else {
    sizeContainer.style.display = 'none';
  }
});

// تحميل المنتجات عند اختيار القطر
document.getElementById('sizeSelect').addEventListener('change', function() {
  const company = document.getElementById('companySelect').value;
  const section = document.getElementById('sectionSelect').value;
  const size = this.value;
  loadItems(company, section, size);
});

// تحميل المنتجات الفعلية
function loadItems(company, section, size) {
  const itemsDiv = document.getElementById('itemsContainer');
  itemsDiv.innerHTML = '';
  const items = productData[company][section][size];
  if (items) {
    items.forEach(item => {
      itemsDiv.innerHTML += `
        <div class="product-item">
          <label>${item.name} – ${item.price} جنيه</label>
          <input type="number" min="0" class="qty-input" data-name="${item.name}" data-price="${item.price}" placeholder="الكمية">
        </div>
      `;
    });
  }
}

// حساب الإجمالي والرسالة
function calculateTotal() {
  let total = 0;
  let message = "🧾 *طلب عرض أسعار مبدئي من حاسبة معرض الصعيدي:*\n\n";
  
  const selectedCompany = document.getElementById('companySelect').value;
  const selectedSection = document.getElementById('sectionSelect').value;
  const selectedSize = document.getElementById('sizeSelect').value;

  message += `🏢 *الشركة:* ${selectedCompany}\n`;
  message += `🏗️ *القسم:* ${selectedSection}\n`;
  if (selectedSize && selectedSize !== 'عام')
    message += `📏 *القطر/المقاس:* ${selectedSize}\n\n`;

  message += "🛒 *تفاصيل المنتجات:*\n";
  let itemsCount = 0;
  const inputs = document.querySelectorAll('.qty-input');

  inputs.forEach(input => {
    const qty = parseFloat(input.value);
    const price = parseFloat(input.dataset.price);
    const name = input.dataset.name;
    if (!isNaN(qty) && qty > 0) {
      const subtotal = qty * price;
      total += subtotal;
      itemsCount++;
      message += `• ${name}\n  💰 ${price} × ${qty} = ${subtotal.toFixed(2)} جنيه\n`;
    }
  });

  if (itemsCount === 0) {
    alert("⚠️ الرجاء تحديد كمية لمنتج واحد على الأقل للمتابعة.");
    return;
  }

  message += `\n💎 *الإجمالي التقديري:* ${total.toFixed(2)} جنيه\n`;
  message += `---------------------------------\n`;
  message += `📍 عرض اسعار قبل الخصم وانتظر حصم خاص من الصعيدي للادوات الصحيه مسجد الرحمن بشتيل.\n`; 
  message += `🌐 *حاسبة معرض الصعيدي للأدوات الصحية – مسجد الرحمن بشتيل إمبابة.*`;

  document.getElementById("totalResult").textContent = `الإجمالي التقديري: ${total.toFixed(2)} جنيه`;

  const encodedMessage = encodeURIComponent(message);
  document.getElementById("whatsappRetail").href = `https://wa.me/${WHATSAPP_RETAIL}?text=${encodedMessage}`;
  document.getElementById("whatsappWholesale").href = `https://wa.me/${WHATSAPP_WHOLESALE}?text=${encodedMessage}`;
  
  document.getElementById("whatsappRetail").style.display = 'block';
  document.getElementById("whatsappWholesale").style.display = 'block';
  document.getElementById("startNewOrder").style.display = 'block';
  document.getElementById("showInvoice").style.display = 'block';

  // حفظ البيانات المؤقتة لعرض الفاتورة
  localStorage.setItem("invoiceMessage", message.replace(/\n/g, "<br>"));
}

// عرض الفاتورة المنسقة
function showInvoice() {
  const invoicePopup = document.getElementById("invoicePopup");
  const details = document.getElementById("invoiceDetails");
  details.innerHTML = localStorage.getItem("invoiceMessage") || "<p>لا توجد بيانات فاتورة بعد.</p>";
  invoicePopup.style.display = "flex";
}

// إغلاق الفاتورة
function closeInvoice() {
  document.getElementById("invoicePopup").style.display = "none";
}

// بدء طلب جديد
function startNewOrder() {
  document.getElementById('companySelect').value = "";
  document.getElementById('sectionSelect').innerHTML = '<option value="">-- اختر القسم --</option>';
  document.getElementById('sizeSelect').innerHTML = '<option value="">-- اختر القطر --</option>';
  document.getElementById('sectionContainer').style.display = 'none';
  document.getElementById('sizeContainer').style.display = 'none';
  document.getElementById('itemsContainer').innerHTML = '';
  document.getElementById("totalResult").textContent = `الإجمالي: 0 جنيه`;
  document.getElementById("whatsappRetail").style.display = 'none';
  document.getElementById("whatsappWholesale").style.display = 'none';
  document.getElementById("startNewOrder").style.display = 'none';
  document.getElementById("showInvoice").style.display = 'none';
  alert("✅ تم تصفير الحاسبة. يمكنك البدء من جديد.");
}

// 🌙 الوضع الليلي
document.getElementById("toggleDarkMode").addEventListener("click", () => {
  document.body.classList.toggle("dark-mode");
});
